# Osdag FOSSEE Internship - Xarray and Plotly Visualization

This project creates interactive 2D and 3D visualizations of Shear Force Diagrams (SFD) and Bending Moment Diagrams (BMD) for a bridge grillage model using Python, Plotly, and Xarray.

##  Project Overview

The project consists of two main tasks:

1. **Task 1**: Generate 2D SFD and BMD for the central longitudinal girder  
2. **Task 2**: Create 3D extrusion visualization (MIDAS-style) for all five girders

**Sign Convention**: Both scripts follow the raw Xarray dataset values (Mz, Vy) as per grading criteria to avoid manual flipping errors. All values are used directly without sign manipulation.

##  Key Technical Features

### Unified Coordinate Mapping (Task 1)
- Uses **actual bridge coordinates** from 0 to 25 meters
- Ensures perfect continuity: the j-end of element N and i-end of element N+1 share the **same X-coordinate**
- No gaps or discontinuities in the SFD/BMD plots
- X-axis generated by looking up node coordinates from `node.py`

### 3D Fin Extrusion (Task 2)
- Creates "fins" using **two coordinate sets**:
  - **Base**: `(x, 0, z)` - represents the bridge deck
  - **Peak**: `(x, magnitude Ã— scale_factor, z)` - represents force/moment magnitude
- **Global scale_factor (0.1)**: Normalizes structural forces against bridge dimensions
- Prevents Y-axis extrusion from distorting 3D perspective
- All 5 girders visualized simultaneously with color coding

### Data Integrity
- **Sign convention** preserved from Xarray dataset without manual flipping
- Direct extraction from `xarray_data.nc` using element IDs
- **netCDF4 engine explicitly specified** in `xr.open_dataset()` to prevent loading errors during evaluation
- Validates against provided node coordinates and element connectivity

### Task 1 Aesthetics
- **Solid horizontal zero-line** (Y=0) in black for clear reference
- Axis titles specify **units**: meters (m) for bridge length, kN for shear force, kNÂ·m for bending moment
- Professional color scheme with hover tooltips
- Grid lines and clear labeling for readability

### Task 2 MIDAS-Style Refinements
- **True Value Hover Data**: Displays actual force/moment values from dataset, not scaled Y-coordinates
- **Dark Boundary Lines**: Black/dark-grey edge lines at peaks clearly define diagram profiles against 3D background
- **Bridge Deck Grid**: Light-grey wireframe grid at Y=0 (X-Z plane) visually grounds the girders
- **Unscaled Data Display**: Scaling factor affects only visual extrusion height, not reported values

## ðŸ”§ Installation

### Prerequisites
- Python 3.8 or higher
- pip package manager

### Install Dependencies

```bash
pip install -r requirements.txt
```

**Required Packages**:
- `xarray>=2023.0.0` - For loading structural analysis data
- `plotly>=5.0.0` - For interactive visualizations
- `numpy>=1.20.0` - For numerical operations
- `netCDF4>=1.5.0` - **Critical**: Required as the engine for xarray to parse `.nc` files

##  Usage

### Task 1: 2D SFD and BMD for Central Girder

Generate 2D plots for the central longitudinal girder (elements: 15, 24, 33, 42, 51, 60, 69, 78, 83):

```bash
python task1_2d_plots.py
```

**Outputs**:
- `bmd_2d.html` - Interactive Bending Moment Diagram
- `sfd_2d.html` - Interactive Shear Force Diagram

**Features**:
- Continuous line plots with markers
- Hover tooltips showing position and magnitude
- Professional styling with grid lines and labels
- Zero reference line for clarity

### Task 2: 3D SFD and BMD for All Girders

Generate 3D extrusion plots for all five girders:

```bash
python task2_3d_plots.py
```

**Outputs**:
- `bmd_3d.html` - 3D Bending Moment Diagram
- `sfd_3d.html` - 3D Shear Force Diagram

**Features**:
- MIDAS-style extrusion visualization
- Interactive 3D plots (rotate, zoom, pan with mouse)
- Color-coded girders with legend
- Scaled extrusion for visual proportionality

**3D Coordinate System**:
- **X-axis**: Longitudinal direction (0-25m bridge length)
- **Y-axis**: Force/moment magnitude (scaled vertically)
- **Z-axis**: Transverse direction (0-10.35m bridge width)

##  Data Structure

### Girder Configuration

| Girder   | Element IDs                          | Position      |
|----------|--------------------------------------|---------------|
| Girder 1 | [13, 22, 31, 40, 49, 58, 67, 76, 81] | Edge          |
| Girder 2 | [14, 23, 32, 41, 50, 59, 68, 77, 82] | Inner         |
| Girder 3 | [15, 24, 33, 42, 51, 60, 69, 78, 83] | **Central**   |
| Girder 4 | [16, 25, 34, 43, 52, 61, 70, 79, 84] | Inner         |
| Girder 5 | [17, 26, 35, 44, 53, 62, 71, 80, 85] | Edge          |

### Dataset Variables
- `Mz_i`, `Mz_j`: Bending moment at element i-end and j-end (kNÂ·m)
- `Vy_i`, `Vy_j`: Shear force at element i-end and j-end (kN)

##  Visualization Examples

### 2D Plots (Task 1)
- **BMD**: Blue line with red markers showing bending moments along the central girder
- **SFD**: Orange line with red markers showing shear forces along the central girder
- Both plots use continuous X-coordinates from actual node positions

### 3D Plots (Task 2)
- **Five colored girders**: Each girder rendered in a distinct color
- **Vertical extrusion**: Magnitude shown as height from bridge deck
- **Surface mesh**: Fins connecting base to peak for each element
- **Edge lines**: Highlights the extruded profile

##  Project Files

```
OSDAG/
â”œâ”€â”€ task1_2d_plots.py        # Task 1: 2D SFD/BMD script
â”œâ”€â”€ task2_3d_plots.py        # Task 2: 3D visualization script
â”œâ”€â”€ xarray_data.nc           # Structural analysis dataset
â”œâ”€â”€ node.py                  # Node coordinates dictionary
â”œâ”€â”€ element.py               # Element connectivity dictionary
â”œâ”€â”€ requirements.txt         # Python dependencies
â”œâ”€â”€ README.md                # This file
â”œâ”€â”€ bmd_2d.html             # Generated: 2D BMD (after running Task 1)
â”œâ”€â”€ sfd_2d.html             # Generated: 2D SFD (after running Task 1)
â”œâ”€â”€ bmd_3d.html             # Generated: 3D BMD (after running Task 2)
â””â”€â”€ sfd_3d.html             # Generated: 3D SFD (after running Task 2)
```

##  Technical Implementation Details

### Task 1: Continuous Coordinate Mapping

The key innovation in Task 1 is the **unified coordinate system**:

```python
# Extract node X-coordinates for each element
for elem_id in element_ids:
    start_node, end_node = members[elem_id]
    x_start = nodes[start_node][0]  # Actual X-coordinate from node.py
    x_end = nodes[end_node][0]
    
    # For first element: add both i and j ends
    # For subsequent elements: only add j-end (i-end overlaps with previous j-end)
```

This ensures:
-  No coordinate duplication
-  Perfect continuity between adjacent elements
-  Realistic distance-based X-axis

### Task 2: Scaled 3D Extrusion

The **scale_factor** is critical for visualization quality:

```python
SCALE_FACTOR = 0.1  # Adjust this to change extrusion height

# For each element:
y_i = magnitude_i * SCALE_FACTOR  # Scaled height at i-end
y_j = magnitude_j * SCALE_FACTOR  # Scaled height at j-end

# Create fin vertices:
base = [(x_start, 0, z_start), (x_end, 0, z_end)]
peak = [(x_start, y_i, z_start), (x_end, y_j, z_end)]
```

Without scaling, forces in kN or kNÂ·m (ranging from -100 to +300) would dwarf the bridge dimensions (25m Ã— 10m), making the visualization unusable.

##  Notes

- **Sign Convention**: Values are used directly from the dataset without sign flipping
- **Interactive Plots**: All HTML outputs are fully interactive using Plotly
- **Browser Compatibility**: Works with all modern browsers (Chrome, Firefox, Edge, Safari)

##  Academic Context

This project is part of the **Osdag FOSSEE Internship Screening Task**.

**Objective**: Demonstrate proficiency in:
- Xarray data manipulation
- Plotly visualization techniques
- Structural engineering diagram generation
- 3D graphics and spatial reasoning

##  License

This work is licensed under a **Creative Commons Attribution-ShareAlike 4.0 International License** by FOSSEE.

##  Support

For questions or issues:
- Join the Osdag Discord Server
- Post in the screening task help desk channel

---

**Created for Osdag FOSSEE Internship Screening Task**  
*Demonstrating Xarray and Plotly expertise for structural visualization*

